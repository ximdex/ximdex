// Generated by CoffeeScript 1.8.0
angular.module("ximdex.main.controller").controller("XSetExtensionsCtrl", [
  "$scope", "$http", "xUrlHelper", "$timeout", "$window", function($scope, $http, xUrlHelper, $timeout, $window) {
    var showMessage, url;
    url = xUrlHelper.getAction({
      action: 'setextensions',
      method: 'update_extensions'
    });
    $scope.saveChanges = function() {
      $scope.loading = true;
      return $http.post(url, {
        states: $scope.commonAllowedExtensions
      }).success(function(data, status, headers, config) {
        $scope.loading = false;
        if (data.message !== "") {
          return showMessage(data.result, data.message);
        }
      }).error(function(data, status, headers, config) {
        return $scope.loading = false;
      });
    };
    return showMessage = function(result, message) {
      $scope.messageClass = result === "ok" ? "message-success" : "message-error";
      $scope.thereAreMessages = true;
      $scope.message = message;
      return $timeout(function() {
        $scope.thereAreMessages = false;
        return $timeout(function() {
          return $scope.message = "";
        }, 500);
      }, 2000);
    };
  }
]);
